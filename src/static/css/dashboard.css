  /* ===== THEME SYSTEM ===== */
  /* Default Dark */
  [data-mode="dark"][data-palette="default"] {
    --bg: #0d1117; --surface: #161b22; --surface2: #21262d;
    --border: #30363d; --text: #e6edf3; --text2: #8b949e;
    --accent: #58a6ff; --green: #3fb950; --yellow: #d29922;
    --red: #f85149; --purple: #bc8cff;
    --group-bg: #0d1117; --group-border: #21262d;
    --copy-bg: #21262d; --copy-hover: #30363d;
    --modal-overlay: rgba(0,0,0,0.7);
  }
  /* Default Light */
  [data-mode="light"][data-palette="default"] {
    --bg: #ffffff; --surface: #f6f8fa; --surface2: #eaeef2;
    --border: #d0d7de; --text: #1f2328; --text2: #656d76;
    --accent: #0969da; --green: #1a7f37; --yellow: #9a6700;
    --red: #cf222e; --purple: #8250df;
    --group-bg: #f6f8fa; --group-border: #d0d7de;
    --copy-bg: #eaeef2; --copy-hover: #d0d7de;
    --modal-overlay: rgba(0,0,0,0.4);
  }
  /* Pink Dark */
  [data-mode="dark"][data-palette="pink"] {
    --bg: #1a0a14; --surface: #2d1225; --surface2: #3d1a33;
    --border: #5c2d4a; --text: #f5dce8; --text2: #b8849e;
    --accent: #ff6eb4; --green: #5cdb95; --yellow: #ffd166;
    --red: #ff4d6d; --purple: #e0aaff;
    --group-bg: #1a0a14; --group-border: #3d1a33;
    --copy-bg: #3d1a33; --copy-hover: #5c2d4a;
    --modal-overlay: rgba(20,5,15,0.8);
  }
  /* Pink Light */
  [data-mode="light"][data-palette="pink"] {
    --bg: #fff5f9; --surface: #fce4ec; --surface2: #f8bbd0;
    --border: #f48fb1; --text: #4a0e2b; --text2: #8c4566;
    --accent: #d81b78; --green: #2e7d57; --yellow: #c77600;
    --red: #c62048; --purple: #9c27b0;
    --group-bg: #fff0f5; --group-border: #f48fb1;
    --copy-bg: #f8bbd0; --copy-hover: #f48fb1;
    --modal-overlay: rgba(74,14,43,0.3);
  }

  /* ===== BASE ===== */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
    background: var(--bg); color: var(--text); line-height: 1.6;
    transition: background 0.2s, color 0.2s; font-size: 15px;
  }
  a { color: var(--accent); text-decoration: none; }
  a:hover { text-decoration: underline; }

  /* ===== HEADER ===== */
  .header {
    background: var(--surface); border-bottom: 1px solid var(--border);
    padding: 12px 24px; display: flex; align-items: center; gap: 14px;
    position: sticky; top: 0; z-index: 100; flex-wrap: wrap;
  }
  .header .logo { font-size: 22px; }
  .header h1 { font-size: 22px; font-weight: 600; white-space: nowrap; }
  .header-credits { font-size: 13px; color: var(--text2); white-space: nowrap; }
  .header-credits a { color: var(--accent); cursor: pointer; }
  .header-right { margin-left: auto; display: flex; align-items: center; gap: 12px; }
  .theme-controls { display: flex; align-items: center; gap: 8px; }
  .theme-btn, .palette-select {
    background: var(--surface2); border: 1px solid var(--border); color: var(--text);
    border-radius: 6px; padding: 5px 12px; font-size: 14px; cursor: pointer;
    transition: background 0.15s;
  }
  .theme-btn:hover, .palette-select:hover { background: var(--copy-hover); }
  .header-meta { color: var(--text2); font-size: 13px; white-space: nowrap; }
  .refresh-dot {
    display: inline-block; width: 7px; height: 7px; border-radius: 50%;
    background: var(--green); margin-right: 4px; animation: pulse 2s infinite;
  }
  @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.3;} }

  /* ===== CONTAINER ===== */
  .container { max-width: 1280px; margin: 0 auto; padding: 20px 24px; }

  /* ===== STATS ===== */
  .stats-row {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 10px; margin-bottom: 20px;
  }
  .stat-card {
    background: var(--surface); border: 1px solid var(--border); border-radius: 8px;
    padding: 14px; text-align: center;
  }
  .stat-card .num { font-size: 30px; font-weight: 700; color: var(--accent); }
  .stat-card .label { font-size: 13px; color: var(--text2); text-transform: uppercase; letter-spacing: 0.5px; }

  /* ===== TABS ===== */
  .tabs { display: flex; gap: 0; margin-bottom: 16px; border-bottom: 2px solid var(--border); }
  .tab {
    padding: 10px 22px; font-size: 16px; font-weight: 500; cursor: pointer;
    color: var(--text2); border-bottom: 2px solid transparent; margin-bottom: -2px;
    transition: color 0.15s, border-color 0.15s;
  }
  .tab:hover { color: var(--text); }
  .tab.active { color: var(--accent); border-bottom-color: var(--accent); }
  .tab .count {
    background: var(--surface2); border-radius: 10px; padding: 2px 8px;
    font-size: 13px; margin-left: 6px;
  }
  .tab.active .count { background: rgba(88,166,255,0.15); color: var(--accent); }

  /* ===== SEARCH ===== */
  .search-bar {
    width: 100%; padding: 11px 16px; background: var(--surface); border: 1px solid var(--border);
    border-radius: 8px; color: var(--text); font-size: 15px; margin-bottom: 16px; outline: none;
  }
  .search-bar:focus { border-color: var(--accent); }
  .search-bar::placeholder { color: var(--text2); }

  /* ===== GROUPS ===== */
  .group {
    margin-bottom: 20px; border: 1px solid var(--group-border);
    border-radius: 10px; overflow: hidden;
  }
  .group-header {
    background: var(--surface); padding: 12px 18px; font-weight: 600; font-size: 16px;
    display: flex; align-items: center; gap: 8px;
    border-bottom: 1px solid var(--group-border); cursor: pointer; user-select: none;
  }
  .group-header .arrow { transition: transform 0.2s; font-size: 10px; color: var(--text2); }
  .group-header.collapsed .arrow { transform: rotate(-90deg); }
  .group-header .group-count { font-size: 13px; color: var(--text2); font-weight: 400; }
  .group-body { display: flex; flex-direction: column; }
  .group-header.collapsed + .group-body { display: none; }

  /* ===== SESSION CARD ===== */
  .session-card {
    background: var(--surface); border-bottom: 1px solid var(--border);
    padding: 14px 16px; transition: background 0.1s;
  }
  .session-card:last-child { border-bottom: none; }
  .session-card:hover { background: var(--surface2); }
  .session-card.active-session { border-left: 3px solid var(--green); }
  .session-card.waiting-session { border-left: 3px solid var(--yellow); }
  .session-card.idle-session { border-left: 3px solid var(--accent); }
  .session-top { display: flex; align-items: flex-start; gap: 10px; cursor: pointer; }
  .session-title { font-weight: 600; font-size: 16px; flex: 1; }
  .session-time { color: var(--text2); font-size: 13px; white-space: nowrap; }
  .live-dot {
    width: 8px; height: 8px; border-radius: 50%; background: var(--green);
    animation: pulse 1.5s infinite; flex-shrink: 0; margin-top: 7px;
  }
  .live-dot.waiting { background: var(--yellow); animation: none; }
  .live-dot.idle { background: var(--accent); animation: none; }
  .session-meta { display: flex; gap: 8px; margin-top: 6px; flex-wrap: wrap; align-items: center; }
  .badge {
    font-size: 12px; padding: 2px 9px; border-radius: 10px; font-weight: 500;
  }
  .badge-repo { background: rgba(88,166,255,0.12); color: var(--accent); }
  .badge-branch { background: rgba(188,140,255,0.12); color: var(--purple); }
  .badge-turns { background: rgba(63,185,80,0.12); color: var(--green); }
  .badge-files { background: rgba(210,153,34,0.12); color: var(--yellow); }
  .badge-cp { background: rgba(248,81,73,0.12); color: var(--red); }
  .badge-active { background: rgba(63,185,80,0.2); color: var(--green); font-weight: 600; }
  .badge-waiting { background: rgba(210,153,34,0.2); color: var(--yellow); font-weight: 600; }
  .badge-working { background: rgba(63,185,80,0.2); color: var(--green); font-weight: 600; }
  .badge-thinking { background: rgba(63,185,80,0.2); color: var(--green); font-weight: 600; }
  .badge-idle { background: rgba(88,166,255,0.2); color: var(--accent); font-weight: 600; }
  .badge-yolo { background: rgba(248,81,73,0.15); color: var(--red); }
  .badge-mcp { background: rgba(188,140,255,0.15); color: var(--purple); }
  .badge-bg { background: rgba(210,153,34,0.15); color: var(--yellow); }
  .badge-focus { cursor: pointer; background: rgba(88,166,255,0.15); color: var(--accent); }
  .badge-focus:hover { background: rgba(88,166,255,0.3); }
  .cwd-text {
    font-family: 'Cascadia Code','Fira Code',monospace; font-size: 13px;
    color: var(--text2); margin-top: 4px;
  }

  /* ===== RESTART COMMAND ===== */
  .restart-row {
    display: flex; align-items: center; gap: 8px; margin-top: 8px;
    background: var(--copy-bg); border-radius: 6px; padding: 8px 12px;
    font-family: 'Cascadia Code','Fira Code',monospace; font-size: 13px;
    color: var(--text2); overflow-x: auto;
  }
  .restart-cmd { flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .copy-btn, .focus-btn {
    background: var(--surface); border: 1px solid var(--border); color: var(--text2);
    border-radius: 4px; padding: 5px 10px; font-size: 13px; cursor: pointer;
    white-space: nowrap; transition: background 0.15s, color 0.15s; flex-shrink: 0;
  }
  .copy-btn:hover, .focus-btn:hover { background: var(--accent); color: #fff; border-color: var(--accent); }
  .copy-btn.copied { background: var(--green); color: #fff; border-color: var(--green); }

  /* ===== DETAIL PANEL ===== */
  .session-detail { display: none; margin-top: 12px; border-top: 1px solid var(--border); padding-top: 12px; }
  .session-card.expanded .session-detail { display: block; }
  .detail-section { margin-bottom: 14px; }
  .detail-section h3 {
    font-size: 14px; color: var(--text2); text-transform: uppercase;
    letter-spacing: 0.5px; margin-bottom: 8px;
  }
  .checkpoint {
    background: var(--surface2); border-radius: 6px; padding: 10px; margin-bottom: 6px;
    border-left: 3px solid var(--accent);
  }
  .checkpoint .cp-title { font-weight: 600; font-size: 15px; }
  .checkpoint .cp-body { color: var(--text2); font-size: 14px; margin-top: 3px; }
  .turn-item { padding: 8px 0; border-bottom: 1px solid var(--border); font-size: 14px; }
  .turn-item:last-child { border-bottom: none; }
  .turn-user { color: var(--accent); font-weight: 500; }
  .turn-assistant { color: var(--text2); }
  .file-list { display: flex; flex-wrap: wrap; gap: 4px; }
  .file-tag {
    font-size: 12px; background: var(--surface2); border: 1px solid var(--border);
    border-radius: 3px; padding: 2px 8px; font-family: 'Cascadia Code','Fira Code',monospace;
  }
  .ref-tag {
    font-size: 12px; background: rgba(63,185,80,0.1); border: 1px solid rgba(63,185,80,0.3);
    border-radius: 3px; padding: 2px 8px; color: var(--green);
  }
  .empty { color: var(--text2); font-style: italic; font-size: 14px; padding: 12px 0; }
  .loading { text-align: center; padding: 30px; color: var(--text2); }

  /* ===== MODAL ===== */
  .modal-overlay {
    display: none; position: fixed; inset: 0; background: var(--modal-overlay);
    z-index: 200; align-items: center; justify-content: center;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: var(--surface); border: 1px solid var(--border); border-radius: 12px;
    padding: 28px; max-width: 900px; width: 90%; max-height: 80vh; overflow-y: auto;
    box-shadow: 0 16px 48px rgba(0,0,0,0.3);
  }
  .modal h2 { font-size: 20px; margin-bottom: 14px; }
  .modal p { color: var(--text2); font-size: 15px; line-height: 1.7; margin-bottom: 10px; }
  .modal ul { color: var(--text2); font-size: 15px; line-height: 1.7; margin-left: 18px; margin-bottom: 10px; }
  .modal .close-btn {
    background: var(--accent); color: #fff; border: none; border-radius: 6px;
    padding: 8px 20px; cursor: pointer; font-size: 13px; margin-top: 8px;
  }
  .tab-panel { display: none; }
  .tab-panel.active { display: block; }

  /* Scrollbar styling */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  /* ===== TILE VIEW ===== */
  .tile-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 12px;
  }
  .tile-card {
    background: var(--surface); border: 1px solid var(--border); border-radius: 10px;
    padding: 14px; cursor: pointer; transition: border-color 0.15s, background 0.15s;
    display: flex; flex-direction: column; gap: 6px; min-height: 100px;
  }
  .tile-card:hover { border-color: var(--accent); background: var(--surface2); }
  .tile-card.active-tile { border-left: 4px solid var(--green); }
  .tile-card.waiting-tile { border-left: 4px solid var(--yellow); }
  .tile-card.idle-tile { border-left: 4px solid var(--accent); }
  .tile-top { display: flex; align-items: baseline; gap: 8px; }
  .tile-top .live-dot { position: relative; top: -1px; }
  .tile-title { font-weight: 600; font-size: 14px; flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .tile-time { font-size: 11px; color: var(--text2); white-space: nowrap; }
  .tile-subtitle { font-size: 12px; color: var(--text2); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .tile-meta { display: flex; gap: 6px; flex-wrap: wrap; align-items: center; }
  .tile-group-header {
    grid-column: 1 / -1; font-weight: 600; font-size: 15px; color: var(--text2);
    padding: 8px 0 2px 0; border-bottom: 1px solid var(--border); margin-top: 4px;
  }

  /* ===== VIEW TOGGLE ===== */
  .view-toggle { display: flex; gap: 4px; }
  .view-btn {
    background: var(--surface2); border: 1px solid var(--border); color: var(--text2);
    border-radius: 6px; padding: 5px 12px; font-size: 14px; cursor: pointer;
    transition: background 0.15s, color 0.15s;
  }
  .view-btn:hover { background: var(--copy-hover); }
  .view-btn.active { background: var(--accent); color: #fff; border-color: var(--accent); }
  .notif-popover {
    display: none; position: absolute; right: 0; top: calc(100% + 8px);
    background: var(--surface2); border: 1px solid var(--border); border-radius: 8px;
    padding: 10px 14px; font-size: 13px; color: var(--text1); white-space: nowrap;
    box-shadow: 0 4px 16px rgba(0,0,0,0.3); z-index: 200; line-height: 1.6;
  }
  .notif-popover.visible { display: block; }
  .notif-popover .pop-title { font-weight: 600; margin-bottom: 4px; }
  .notif-popover .pop-step { color: var(--text2); }
  .notif-popover .pop-step span { color: var(--accent); font-weight: 600; }
  #notif-wrap { position: relative; }

  /* ===== DETAIL MODAL ===== */
  .detail-modal-overlay {
    display: none; position: fixed; inset: 0; background: var(--modal-overlay);
    z-index: 200; align-items: flex-start; justify-content: center; padding-top: 60px;
  }
  .detail-modal-overlay.open { display: flex; }
  .detail-modal {
    background: var(--surface); border: 1px solid var(--border); border-radius: 12px;
    padding: 24px; max-width: 700px; width: 95%; max-height: 80vh; overflow-y: auto;
    box-shadow: 0 16px 48px rgba(0,0,0,0.3);
  }
  .detail-modal-header { display: flex; align-items: center; gap: 10px; margin-bottom: 16px; }
  .detail-modal-header h2 { font-size: 18px; flex: 1; }
  .detail-modal-header .close-x {
    background: none; border: none; color: var(--text2); font-size: 22px;
    cursor: pointer; padding: 4px 8px; border-radius: 4px;
  }
  .detail-modal-header .close-x:hover { background: var(--surface2); color: var(--text); }
